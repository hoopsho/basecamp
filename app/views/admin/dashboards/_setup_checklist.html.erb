<%# Setup checklist for new users â€” shows what needs configuring before the engine works %>
<% if @setup_complete %>
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border-2 border-green-200 dark:border-green-800 overflow-hidden">
    <div class="px-6 py-4 flex items-center gap-3">
      <%= svg_icon('check-circle', class: 'w-6 h-6 text-green-500 flex-shrink-0') %>
      <div>
        <h2 class="text-lg font-semibold text-green-800 dark:text-green-200">All set!</h2>
        <p class="text-sm text-green-600 dark:text-green-400">All services and integrations are configured. The SOP Engine is ready to run.</p>
      </div>
    </div>
  </div>
<% else %>
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"
       data-controller="toggle">
    <%# Header %>
    <button class="w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"
            data-action="click->toggle#toggle"
            data-toggle-target="button"
            aria-expanded="true">
      <div class="flex items-center gap-3">
        <%= svg_icon('rocket', class: 'w-6 h-6 text-primary-500') %>
        <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Getting Started</h2>
        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900/30 text-primary-800 dark:text-primary-200">
          <%= @setup_progress %>
        </span>
      </div>
      <%= svg_icon('chevron-down', class: 'w-5 h-5 text-gray-400 transition-transform') %>
    </button>

    <%# Checklist body %>
    <div data-toggle-target="content">
      <div class="border-t border-gray-200 dark:border-gray-700 divide-y divide-gray-100 dark:divide-gray-700/50">
        <% @setup_checks.each do |check| %>
          <div class="px-6 py-3 flex items-center gap-4">
            <div class="flex-shrink-0">
              <% if check[:passed] %>
                <%= svg_icon('check-circle', class: 'w-5 h-5 text-green-500') %>
              <% else %>
                <%= svg_icon('x-circle', class: 'w-5 h-5 text-red-400') %>
              <% end %>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium <%= check[:passed] ? 'text-gray-500 dark:text-gray-400' : 'text-gray-900 dark:text-gray-100' %>">
                <%= check[:label] %>
              </p>
              <p class="text-xs text-gray-500 dark:text-gray-400"><%= check[:description] %></p>
            </div>
            <% unless check[:passed] %>
              <%= link_to check[:path], class: "flex-shrink-0 p-1.5 text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 transition-colors" do %>
                <%= svg_icon('arrow-right', class: 'w-4 h-4') %>
              <% end %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
